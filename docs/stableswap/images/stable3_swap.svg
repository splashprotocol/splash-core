<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1638px" height="435px" viewBox="-0.5 -0.5 1638 435" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="1102" y="2" width="533" height="35" rx="5.25" ry="5.25" fill-opacity="0.8" fill="#51a931" stroke="#2d7600" stroke-opacity="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 531px; height: 1px; padding-top: 20px; margin-left: 1103px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;" face="Courier New" color="#000000"><b style="">Swap</b></font></div></div></div></foreignObject><text x="1369" y="23" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap</text></switch></g><path d="M 176.5 153.5 L 176.5 143.5 L 323.33 143.5 L 323.33 137.44 L 360.5 148.5 L 323.33 159.56 L 323.33 153.5 Z" fill="#c7e5fc" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><rect x="1461" y="262" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="1470.17" y="349" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><rect x="1470.17" y="269.5" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 307px; margin-left: 1471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: 12px;">User Output</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1508" y="311" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">User Output&#xa;</text></switch></g><rect x="1551.5" y="269.5" width="75" height="75" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 307px; margin-left: 1553px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1589" y="311" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="1551" y="349" width="75" height="75" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 387px; margin-left: 1552px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font face="Courier New" style="font-size: 10px;"><b> Reserves:<br /><div style="text-align: left;"><span style="background-color: initial; font-weight: normal;">Z: z_u</span></div></b></font></div></div></div></foreignObject><text x="1589" y="390" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Reserves:...</text></switch></g><rect x="361" y="63.5" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="370.17" y="150.5" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 188px; margin-left: 371px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b>Data:</b><br />- swap_data<br /><br style="border-color: var(--border-color);" /></span></div></div></div></foreignObject><text x="408" y="192" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Data:...</text></switch></g><rect x="370.17" y="71" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 371px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: 12px;">Swap Order</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="408" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap Order&#xa;</text></switch></g><rect x="451.5" y="71" width="75" height="75" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 453px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: x-small;">Swap Validation Logic</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="489" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap Validat...</text></switch></g><rect x="451" y="150.5" width="75" height="75" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 188px; margin-left: 452px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font face="Courier New" style="font-size: 10px;"><b> Reserves:<br /><div style="text-align: left;"><span style="background-color: initial; font-weight: normal;">X: x_u</span></div></b></font></div></div></div></foreignObject><text x="489" y="192" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Reserves:...</text></switch></g><rect x="2" y="63.5" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="11.17" y="150.5" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><rect x="11.17" y="71" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 12px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color);"><b style="border-color: var(--border-color); font-size: 12px;">User Input</b></b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="49" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">User Input&#xa;</text></switch></g><rect x="92.5" y="71" width="75" height="75" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 94px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="130" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle"></text></switch></g><rect x="2" y="2" width="533" height="35" rx="5.25" ry="5.25" fill-opacity="0.8" fill="#ffce9f" stroke="#d6b656" stroke-opacity="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 531px; height: 1px; padding-top: 20px; margin-left: 3px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;" face="Courier New"><b style="">Swap Order</b></font></div></div></div></foreignObject><text x="269" y="23" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap Order</text></switch></g><rect x="92.5" y="150.5" width="75" height="75" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 73px; height: 1px; padding-top: 188px; margin-left: 95px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font face="Courier New" style="font-size: 10px;"><b>  Reserves:</b></font><span style="font-weight: bold; font-size: 10px; font-family: &quot;Courier New&quot;; background-color: initial;"> <br /></span><span style="background-color: initial; font-size: 10px; font-family: &quot;Courier New&quot;;"> X: x_u<br /></span><span style="background-color: initial; font-size: 10px; font-family: &quot;Courier New&quot;;"> Y: y_u<br /></span><span style="background-color: initial; font-size: 10px; font-family: &quot;Courier New&quot;;"> Z: z_u</span><span style="background-color: initial; font-size: 10px; font-family: &quot;Courier New&quot;;"><br /></span></div></div></div></foreignObject><text x="95" y="192" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">Reserves:...</text></switch></g><rect x="1102" y="63.5" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="1109.58" y="150.5" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 188px; margin-left: 1111px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b>Data:</b><br />- pool_data<br /><div style="text-align: left;"></div></span></div></div></div></foreignObject><text x="1147" y="192" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Data:...</text></switch></g><rect x="1109.58" y="71" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 1111px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: 12px;">Pool</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1147" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Pool&#xa;</text></switch></g><rect x="1192.91" y="71" width="75.5" height="48.5" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 74px; height: 1px; padding-top: 95px; margin-left: 1194px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: x-small;">Stable3Pool Validation Logic</b></b></div></div></div></foreignObject><text x="1231" y="99" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Stable3Pool...</text></switch></g><rect x="1192.91" y="123.5" width="75.5" height="102" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 74px; height: 1px; padding-top: 175px; margin-left: 1194px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 10px;"><font face="Courier New" style="border-color: var(--border-color); color: rgb(0, 0, 0); text-align: left; font-size: 10px;"><b style="border-color: var(--border-color);"> Reserves:</b></font><font style="border-color: var(--border-color); color: rgb(0, 0, 0); font-size: 10px;"> <br style="border-color: var(--border-color);" /><div style="text-align: left;"><font face="Courier New"><span style="background-color: initial;">poolNFT: 1</span><br /></font></div><div style="text-align: left;"><span style="background-color: initial;"><font face="Courier New">X: x</font></span></div><div style="text-align: left;"><span style="background-color: initial;"><font face="Courier New">Y: y</font></span></div><div style="text-align: left;"><span style="background-color: initial;"><font face="Courier New">Z: z</font></span></div><div style="text-align: left;"><span style="background-color: initial;"><font face="Courier New">LP: lp</font></span></div></font></font></div></div></div></foreignObject><text x="1231" y="178" fill="#333333" font-family="Helvetica" font-size="12px" text-anchor="middle">Reserves:...</text></switch></g><rect x="1461" y="63.5" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="1470.17" y="150.5" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 188px; margin-left: 1471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b>Data:</b><br />- pool_data'<br /></span></div></div></div></foreignObject><text x="1508" y="192" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Data:...</text></switch></g><rect x="1470.17" y="71" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 109px; margin-left: 1471px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: 12px;">Pool'</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1508" y="112" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Pool'&#xa;</text></switch></g><rect x="1553.5" y="71" width="75.5" height="48.5" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 74px; height: 1px; padding-top: 95px; margin-left: 1555px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: x-small;">Stable3Pool Validation Logic</b></b></div></div></div></foreignObject><text x="1591" y="99" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Stable3Pool...</text></switch></g><rect x="1553.5" y="123.5" width="75.5" height="102" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 74px; height: 1px; padding-top: 175px; margin-left: 1556px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="text-align: center;"><font face="Courier New" style="background-color: initial; border-color: var(--border-color); font-size: 10px; color: rgb(0, 0, 0);"><b style="border-color: var(--border-color);">  Reserves:</b></font><font style="background-color: initial; border-color: var(--border-color); font-size: 10px; color: rgb(0, 0, 0);"> </font></div><font style="border-color: var(--border-color); font-size: 10px; color: rgb(0, 0, 0);"><div style="border-color: var(--border-color);"><font face="Courier New" style="border-color: var(--border-color);"> poolNFT: 1<br style="border-color: var(--border-color);" /></font></div><div style="border-color: var(--border-color);"><span style="border-color: var(--border-color); background-color: initial;"><font face="Courier New" style="border-color: var(--border-color);"> X: x + x_u</font></span></div><div style="border-color: var(--border-color);"><span style="border-color: var(--border-color); background-color: initial;"><font face="Courier New" style="border-color: var(--border-color);"> Y: y</font></span></div><div style="border-color: var(--border-color);"><span style="border-color: var(--border-color); background-color: initial;"><font face="Courier New" style="border-color: var(--border-color);"> Z: z - z_u</font></span></div><div style="border-color: var(--border-color);"><span style="border-color: var(--border-color); background-color: initial;"><font face="Courier New" style="border-color: var(--border-color);"> LP: lp</font></span></div></font></div></div></div></foreignObject><text x="1556" y="178" fill="#333333" font-family="Helvetica" font-size="12px">Reserves:...</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 128px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;"><font face="Courier New" style="font-size: 10px; background-color: rgb(255, 255, 255);">(x_u, y_u, z_u)</font></div></div></div></foreignObject><text x="261" y="131" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">(x_u, y_u, z_u)</text></switch></g><rect x="552.5" y="2" width="533" height="35" rx="5.25" ry="5.25" fill-opacity="0.8" fill="#ffd966" stroke="#d6b656" stroke-opacity="0.8" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 531px; height: 1px; padding-top: 20px; margin-left: 554px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;" face="Courier New"><b style="">Off-chain Calculations</b></font></div></div></div></foreignObject><text x="819" y="23" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Off-chain Calculations</text></switch></g><rect x="1102" y="262" width="174" height="170" fill="#f5f5f5" stroke="#666666" pointer-events="all"/><rect x="1111.17" y="349" width="75" height="75" fill="#d5e8d4" stroke="#82b366" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 387px; margin-left: 1112px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b>Data:</b><br />- swap_data<br /><br style="border-color: var(--border-color);" /></span></div></div></div></foreignObject><text x="1149" y="390" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Data:...</text></switch></g><rect x="1111.17" y="269.5" width="75" height="75" fill="#fff2cc" stroke="#d6b656" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 307px; margin-left: 1112px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: 12px;">Swap Order</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1149" y="311" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap Order&#xa;</text></switch></g><rect x="1192.5" y="269.5" width="75" height="75" fill="#f8cecc" stroke="#b85450" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 307px; margin-left: 1194px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><b style="border-color: var(--border-color); font-family: &quot;Courier New&quot;; font-size: 10px;"><b style="border-color: var(--border-color); font-size: x-small;">Swap Validation Logic</b><br style="border-color: var(--border-color);" /></b></div></div></div></foreignObject><text x="1230" y="311" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Swap Validat...</text></switch></g><rect x="1192" y="349" width="75" height="75" fill="#faf8f0" stroke="#000000" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 387px; margin-left: 1193px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font face="Courier New" style="font-size: 10px;"><b> Reserves:<br /><div style="text-align: left;"><span style="background-color: initial; font-weight: normal;">X: x_u</span></div></b></font></div></div></div></foreignObject><text x="1230" y="390" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Reserves:...</text></switch></g><path d="M 1272.7 154.29 L 1279.98 147.44 L 1438.82 316.15 L 1443.23 312 L 1460.66 346.64 L 1427.13 327.15 L 1431.54 323 Z" fill="#c7e5fc" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><path d="M 1280 350.04 L 1272.68 343.23 L 1431.66 172.65 L 1427.23 168.52 L 1460.66 148.87 L 1443.41 183.59 L 1438.98 179.46 Z" fill="#c7e5fc" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 168px; margin-left: 1406px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;"><font face="Courier New" style="font-size: 10px; background-color: rgb(255, 255, 255);">(x_u)</font></div></div></div></foreignObject><text x="1406" y="171" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">(x_u)</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 327px; margin-left: 1406px;"><div data-drawio-colors="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;"><font face="Courier New" style="font-size: 10px; background-color: rgb(255, 255, 255);">(z_u)</font></div></div></div></foreignObject><text x="1406" y="330" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="11px" text-anchor="middle">(z_u)</text></switch></g><rect x="552" y="63.5" width="533.5" height="308.5" rx="46.27" ry="46.27" fill="#faf8f0" stroke="#c7e5fc" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 532px; height: 1px; padding-top: 218px; margin-left: 553px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="border-color: var(--border-color);"><font face="Courier New" style="font-size: 12px;"><b style="background-color: initial;">Off-chain operator should:</b></font></div><div style="border-color: var(--border-color);"><font face="Courier New" style="font-size: 12px;"><b style="background-color: initial;"><br /></b></font></div><div style="border-color: var(--border-color);"><font face="Courier New">(It is assumed that the current accumulated fees of the protocol at the start of the action are all equal to zero; if they are not zero, then they must be subtracted from the current balances before calculations)</font><font face="Courier New" style="font-size: 12px;"><b style="background-color: initial;"><br /></b></font></div><div style="border-color: var(--border-color);"><ul style=""><li><span style="background-color: initial; font-family: &quot;Courier New&quot;; border-color: var(--border-color);"> Calculate o</span><span style="background-color: initial; font-family: &quot;Courier New&quot;;">utput assets amounts according to the protocol's logic:</span><br /></li><ul><li style="text-align: left;"><span style="background-color: initial; font-family: &quot;Courier New&quot;;">Solve f(z; D0, x + x_u, y) = 0 numerically</span> <font face="Courier New">to receive new balance of Z value z';</font></li><li style="text-align: left;"><font face="Courier New">Apply fees to the (z - z') difference to receive the final value z_u received by user and protocol fee z_p;</font></li><li style="border-color: var(--border-color); text-align: left;"><font face="Courier New">Solve f(D; x + x_u, y, z - z_u - z_p) = 0 numerically</font> <font face="Courier New">to receive new invariant value D2;</font></li></ul><li style="border-color: var(--border-color); text-align: left;"><font face="Courier New"> Put the calculated values ​​of the assets <span style="border-color: var(--border-color); background-color: initial;">amounts</span><span style="border-color: var(--border-color); background-color: initial;"> into the   corresponding outputs and new invariant value D2 with updated   protocol fees into the pool's data.</span></font></li></ul></div></div></div></div></foreignObject><text x="819" y="221" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Off-chain operator should:...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>